# IQMol Exploit

## instructions
- build clean binary without instrumentation (remove flags in linux.pri) and without afl optimization
- see [new harness](../02%20fuzzing/harness_exploit.C)
- install [qt5printers](https://github.com/Lekensteyn/qt5printers) to be able to print qt5 types
- open in gdb: `gdb <binary name>` and run with `run <args>`

## gdb cheatsheet
| command                   | description            |
|---------------------------|------------------------|
| `si`                      | single instruction     |
| `n`                       | next line              |
| `c`                       | continue to breakpoint |
| `b <function>`            | setting breakpoints    |
| `d`                       | deleting breakpoints   |
| `p <variable name>`       | print variable content |
| `bt`                      | print backtrace        |
| `display <variable name>` | track variable values  |

# constructed bug

- build with new [linux.pri](constructed_bug/linux.pri) and modified [QChemInputParser.C](constructed_bug/QChemInputParser.C)
- this introduces a new useless function `check_string`, that just strcpy the current line to a 1024 bit buffer.
- -> stack overflow for all lines with more than 1024 characters
- found addresses for buffer and rsp are [here](constructed_bug/adresses.txt)
- Problem: QString has no function that reads the input line and then dumps to `char*` without using an encoding
- -> nop sled will be converted to `bf bd ef` as it can be seen in [hexdump](constructed_bug/hexdump.png)
